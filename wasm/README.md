# WebAssembly

本章重在介绍 `WebAssembly` 相关知识，主要资料来源于官方资料的翻译及部分实践。


## Q-A

### Q: WebAssembly 是什么？

A: WebAssembly(简写为Wasm，注意这里不是首字母缩写，而是简写，所以只有首字母W是大写) 是一种<b>安全</b>、<b>可移植</b>、专注于<b>高效执行</b>且同时表达简洁的<b>底层代码格式</b>。它的诞生始于为Web应用提供高性能能力，但它没有专门针对Web来提供一些特性和能力，所以它同样能应用在非Web的环境。

A: Wasm 同时是一项由W3C组织维护的一套开放标准。目前(本文档日期2021-09-05)最新版本为(Draft 2021-08-19)。

### Q: WebAssembly 的设计目标？

A: 快速，安全以及可移植。

- Fast，快速：接近于原生代码的执行性能，能够利用所有现代硬件的各种高级特性，详细可以参看[高效执行的底层设计](https://webassembly.org/docs/portability/#assumptions-for-efficient-execution)。

- Safe，安全：Wasm代码执行在一个内存安全的沙箱环境，最大程度的防止数据出错和安全漏洞。

- Portable，可移植性：
  
  - Hardware-independent，硬件无关：可以运行在所有现代架构的设备上，包括PC、移动设备，嵌入式设备等。
  
  - Language-independent，语言无关：不基于任何实际编程语言、编程模型、或者对象模型。
  
  - Platform-independent，平台无关：可以嵌入在浏览器中执行、也可以以单独的虚拟机形式来执行、或者嵌入到其它的执行环境中。
  
  - Open、开放：程序以一种简单与通用的方式与它所在的环境进行互操作。
  
A: 高效及可移植概要

- Compact，简洁高效的表达形式：Wasm支持两种格式的表达形式，一种类似汇编的文本表达格式，另一种是更简洁和更快的二进制表达格式，二进制表达格式可以通过类汇编文字格式或者其它自然语言转译得到。

- Modular，模块化：程序可以分隔成多个独立小模块，可以各自加载、缓存和使用。

- Efficient，高效：代码可以在快速的单次加载中以(JIT，Just-In-Time，即时编译技术)或(AOT，Ahead-Of-Time，提前编译)解码、验证、编译。 

- Streamable，流式加载：上述解码、验证、和编译的过程可以与加载过程同步进行，而不必等待所有代码加载完成。

- Parallelizable，并行化：上述解码、验证和编译的过程可以被分割成多个并行任务并行执行。

- Portable，可移植性：不提供被现今硬件所广泛支持的特性支持。

`Wasm` 同时追求代码易于调试和追踪，尤其是在浏览器中，但这有赖于被嵌入环境自身的实现，所以不在规范里做过多探讨。

### Q: `Wasm` 有关依赖？

A: `Wasm` 依赖两个规范标准：

- IEEE754-2019，浮点数标准，主要是依赖于浮点数格式的定义及浮点数的操作定义。

- Unicode，Unicode编码规范，主要是用在名称及文本表达格式上。

## 文档导航

- [WebAssembly文本格式详解](./WebAssemblyTextFormat.md)
